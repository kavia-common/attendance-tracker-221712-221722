{"is_source_file": true, "format": "Python", "description": "This file implements an authentication module for a Flask-based web service. It provides endpoints for user signup, login, token verification, and role-based access control using JWT tokens. The code manages an in-memory user store, issues and verifies tokens, and includes decorators for protecting routes based on authentication and roles.", "external_files": ["flask", "flask_smorest", "werkzeug.security", "jwt (PyJWT)"], "external_methods": ["flask.request.get_json", "flask.jsonify", "flask.g", "jwt.encode", "jwt.decode", "generate_password_hash", "check_password_hash"], "published": ["jwt_required", "roles_required"], "classes": [{"name": "JwtConfig", "description": "Data class for JWT configuration parameters, including methods to load from environment variables."}], "methods": [{"name": "str _issue_token(sub: str, role: str, extra: Optional[Dict[str, Any]] = None)", "description": "Creates a JWT token with subject, role, and optional extra claims.", "scope": "", "scopeKind": ""}, {"name": "Tuple[bool,Optional[Dict[str,Any]],Optional[str]] _verify_token(token: str)", "description": "Verifies a JWT token, returning validity status, payload, and error message.", "scope": "", "scopeKind": ""}, {"name": "jwt_required(f)", "description": "Decorator enforcing presence of a valid JWT in request headers.", "scope": "", "scopeKind": ""}, {"name": "roles_required(*roles: str)", "description": "Decorator restricting route access to users with specified roles.", "scope": "", "scopeKind": ""}, {"name": "Optional[str] _validate_signup_payload(data: Dict[str, Any])", "description": "Validates the payload for user signup requests.", "scope": "", "scopeKind": ""}, {"name": "Optional[str] _validate_login_payload(data: Dict[str, Any])", "description": "Validates the payload for login requests.", "scope": "", "scopeKind": ""}, {"name": "admin_ping()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "decorator(f)", "scope": "roles_required", "scopeKind": "function", "description": "unavailable"}, {"name": "\"JwtConfig\" from_env()", "scope": "JwtConfig", "scopeKind": "class", "description": "unavailable"}, {"name": "login()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "me()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "signup()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "wrapper(*args, **kwargs)", "scope": "jwt_required", "scopeKind": "function", "description": "unavailable"}], "calls": ["_issue_token", "_verify_token", "JwtConfig.from_env", "generate_password_hash", "check_password_hash", "jsonify", "request.get_json"], "search-terms": ["JWT auth", "Flask auth endpoints", "Role-based access control", "In-memory user store", "Token verification", "Login/signup API", "auth decorator"], "state": 2, "file_id": 8, "knowledge_revision": 42, "git_revision": "33676f50dbd6cd321d67cbddd2476c6e839e5be5", "revision_history": [{"18": ""}, {"26": "e01713babe97f5fa6ae4aadb69ee56a045c6b141"}, {"31": "33676f50dbd6cd321d67cbddd2476c6e839e5be5"}, {"42": "33676f50dbd6cd321d67cbddd2476c6e839e5be5"}], "ctags": [{"_type": "tag", "name": "JwtConfig", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^class JwtConfig:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "_USERS", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^_USERS: Dict[str, Dict[str, Any]] = {}$/", "language": "Python", "typeref": "typename:Dict[str, Dict[str, Any]]", "kind": "variable"}, {"_type": "tag", "name": "_issue_token", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^def _issue_token(sub: str, role: str, extra: Optional[Dict[str, Any]] = None) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(sub: str, role: str, extra: Optional[Dict[str, Any]] = None)"}, {"_type": "tag", "name": "_validate_login_payload", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^def _validate_login_payload(data: Dict[str, Any]) -> Optional[str]:$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "function", "signature": "(data: Dict[str, Any])"}, {"_type": "tag", "name": "_validate_signup_payload", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^def _validate_signup_payload(data: Dict[str, Any]) -> Optional[str]:$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "function", "signature": "(data: Dict[str, Any])"}, {"_type": "tag", "name": "_verify_token", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^def _verify_token(token: str) -> Tuple[bool, Optional[Dict[str, Any]], Optional[str]]:$/", "language": "Python", "typeref": "typename:Tuple[bool,Optional[Dict[str,Any]],Optional[str]]", "kind": "function", "signature": "(token: str)"}, {"_type": "tag", "name": "admin_ping", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^def admin_ping():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "blp", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^blp = Blueprint($/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "decorator", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^    def decorator(f):$/", "file": true, "language": "Python", "kind": "function", "signature": "(f)", "scope": "roles_required", "scopeKind": "function"}, {"_type": "tag", "name": "from_env", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^    def from_env() -> \"JwtConfig\":$/", "language": "Python", "typeref": "typename:\"JwtConfig\"", "kind": "member", "signature": "()", "scope": "JwtConfig", "scopeKind": "class"}, {"_type": "tag", "name": "jwt_required", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^def jwt_required(f):$/", "language": "Python", "kind": "function", "signature": "(f)"}, {"_type": "tag", "name": "login", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^def login():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "me", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^def me():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "roles_required", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^def roles_required(*roles: str):$/", "language": "Python", "kind": "function", "signature": "(*roles: str)"}, {"_type": "tag", "name": "signup", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^def signup():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "wrapper", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^        def wrapper(*args, **kwargs):$/", "file": true, "language": "Python", "kind": "function", "signature": "(*args, **kwargs)", "scope": "roles_required.decorator", "scopeKind": "function"}, {"_type": "tag", "name": "wrapper", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^    def wrapper(*args, **kwargs):$/", "file": true, "language": "Python", "kind": "function", "signature": "(*args, **kwargs)", "scope": "jwt_required", "scopeKind": "function"}], "hash": "c09e024ff3698a2a3764e559bfc40ff1", "format-version": 4, "code-base-name": "firebase_functions", "filename": "firebase_functions/app/auth.py", "fields": [{"name": "Dict[str, Dict[str, Any]] _USERS", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "blp = Blueprint(", "scope": "", "scopeKind": "", "description": "unavailable"}]}