{"is_source_file": true, "format": "Python", "description": "This source file implements authentication functionalities for a web application using Flask. It includes user signup, login, JWT token issuance and verification, role-based access control, and user info retrieval.", "external_files": ["flask", "werkzeug.security", "jwt"], "external_methods": ["generate_password_hash", "check_password_hash", "jwt.encode", "jwt.decode"], "published": ["jwt_required", "roles_required", "sign_up", "login", "me", "admin_ping"], "classes": [{"name": "JwtConfig", "description": "A dataclass that holds configuration for JWT token encoding and decoding, loaded from environment variables."}], "methods": [{"name": "str _issue_token(sub: str, role: str, extra: Optional[Dict[str, Any]] = None)", "description": "Creates a JWT token with user info and optional extra payload.", "scope": "", "scopeKind": ""}, {"name": "Tuple[bool,Optional[Dict[str,Any]],Optional[str]] _verify_token(token: str)", "description": "Verifies a JWT token's validity and extracts its payload.", "scope": "", "scopeKind": ""}, {"name": "jwt_required(f)", "description": "Decorator enforcing JWT authentication on routes.", "scope": "", "scopeKind": ""}, {"name": "roles_required(*roles: str)", "description": "Decorator enforcing role-based access control on routes.", "scope": "", "scopeKind": ""}, {"name": "Optional[str] _validate_signup_payload(data: Dict[str, Any])", "description": "Validates the JSON payload for user signup.", "scope": "", "scopeKind": ""}, {"name": "Optional[str] _validate_login_payload(data: Dict[str, Any])", "description": "Validates the JSON payload for user login.", "scope": "", "scopeKind": ""}, {"name": "signup()", "description": "Endpoint to create a new user account and issue a JWT.", "scope": "", "scopeKind": ""}, {"name": "login()", "description": "Endpoint for user login, verifying credentials and issuing a JWT.", "scope": "", "scopeKind": ""}, {"name": "me()", "description": "Fetches current user's info based on the JWT provided.", "scope": "", "scopeKind": ""}, {"name": "admin_ping()", "description": "A protected route accessible only to users with 'admin' role, demonstrating role-based access.", "scope": "", "scopeKind": ""}, {"name": "decorator(f)", "scope": "roles_required", "scopeKind": "function", "description": "unavailable"}, {"name": "\"JwtConfig\" from_env()", "scope": "JwtConfig", "scopeKind": "class", "description": "unavailable"}, {"name": "wrapper(*args, **kwargs)", "scope": "jwt_required", "scopeKind": "function", "description": "unavailable"}], "calls": ["jwt.encode", "jwt.decode", "generate_password_hash", "check_password_hash", "_verify_token", "_issue_token"], "search-terms": ["JWT authentication", "Flask auth blueprint", "role-based access control", "token verification", "user signup and login", "password hashing"], "state": 2, "file_id": 8, "knowledge_revision": 26, "git_revision": "e01713babe97f5fa6ae4aadb69ee56a045c6b141", "revision_history": [{"18": ""}, {"26": "e01713babe97f5fa6ae4aadb69ee56a045c6b141"}], "ctags": [{"_type": "tag", "name": "JwtConfig", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^class JwtConfig:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "_USERS", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^_USERS: Dict[str, Dict[str, Any]] = {}$/", "language": "Python", "typeref": "typename:Dict[str, Dict[str, Any]]", "kind": "variable"}, {"_type": "tag", "name": "_issue_token", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^def _issue_token(sub: str, role: str, extra: Optional[Dict[str, Any]] = None) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(sub: str, role: str, extra: Optional[Dict[str, Any]] = None)"}, {"_type": "tag", "name": "_validate_login_payload", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^def _validate_login_payload(data: Dict[str, Any]) -> Optional[str]:$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "function", "signature": "(data: Dict[str, Any])"}, {"_type": "tag", "name": "_validate_signup_payload", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^def _validate_signup_payload(data: Dict[str, Any]) -> Optional[str]:$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "function", "signature": "(data: Dict[str, Any])"}, {"_type": "tag", "name": "_verify_token", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^def _verify_token(token: str) -> Tuple[bool, Optional[Dict[str, Any]], Optional[str]]:$/", "language": "Python", "typeref": "typename:Tuple[bool,Optional[Dict[str,Any]],Optional[str]]", "kind": "function", "signature": "(token: str)"}, {"_type": "tag", "name": "admin_ping", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^def admin_ping():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "blp", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^blp = Blueprint($/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "decorator", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^    def decorator(f):$/", "file": true, "language": "Python", "kind": "function", "signature": "(f)", "scope": "roles_required", "scopeKind": "function"}, {"_type": "tag", "name": "from_env", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^    def from_env() -> \"JwtConfig\":$/", "language": "Python", "typeref": "typename:\"JwtConfig\"", "kind": "member", "signature": "()", "scope": "JwtConfig", "scopeKind": "class"}, {"_type": "tag", "name": "jwt_required", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^def jwt_required(f):$/", "language": "Python", "kind": "function", "signature": "(f)"}, {"_type": "tag", "name": "login", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^def login():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "me", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^def me():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "roles_required", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^def roles_required(*roles: str):$/", "language": "Python", "kind": "function", "signature": "(*roles: str)"}, {"_type": "tag", "name": "signup", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^def signup():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "wrapper", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^        def wrapper(*args, **kwargs):$/", "file": true, "language": "Python", "kind": "function", "signature": "(*args, **kwargs)", "scope": "roles_required.decorator", "scopeKind": "function"}, {"_type": "tag", "name": "wrapper", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^    def wrapper(*args, **kwargs):$/", "file": true, "language": "Python", "kind": "function", "signature": "(*args, **kwargs)", "scope": "jwt_required", "scopeKind": "function"}], "hash": "233507589886c3894c0c7be8bcdaec77", "format-version": 4, "code-base-name": "firebase_functions", "filename": "firebase_functions/app/auth.py", "fields": [{"name": "Dict[str, Dict[str, Any]] _USERS", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "blp = Blueprint(", "scope": "", "scopeKind": "", "description": "unavailable"}]}