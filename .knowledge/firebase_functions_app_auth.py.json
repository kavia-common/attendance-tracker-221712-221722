{"is_source_file": true, "format": "Python", "description": "This file implements authentication functionality for a web application, including JWT token issuance and verification, user signup and login endpoints, and role-based access control decorators. It uses Flask, Flask-Smorest, and JWT libraries, along with in-memory user storage for demonstration purposes.", "external_files": ["flask", "flask_smorest", "werkzeug.security", "jwt"], "external_methods": ["os.getenv", "datetime.datetime.utcnow", "jwt.encode", "jwt.decode", "generate_password_hash", "check_password_hash"], "published": ["jwt_required", "roles_required"], "classes": [{"name": "JwtConfig", "description": "Dataclass for managing JWT configuration parameters such as secret key, algorithm, and token expiration minutes."}], "methods": [{"name": "str _issue_token(sub: str, role: str, extra: Optional[Dict[str, Any]] = None)", "description": "Generates a JWT token with subject, role, and optional extra claims, using configuration from environment variables.", "scope": "", "scopeKind": ""}, {"name": "Tuple[bool,Optional[Dict[str,Any]],Optional[str]] _verify_token(token: str)", "description": "Verifies a JWT token and returns whether it is valid along with its payload or error message.", "scope": "", "scopeKind": ""}, {"name": "jwt_required(f)", "description": "Decorator that enforces presence of a valid JWT in the Authorization header.", "scope": "", "scopeKind": ""}, {"name": "roles_required(*roles: str)", "description": "Decorator enforcing access to users with specified roles.", "scope": "", "scopeKind": ""}, {"name": "Optional[str] _validate_signup_payload(data: Dict[str, Any])", "description": "Validates signup request data ensuring email, password, and role are present and valid.", "scope": "", "scopeKind": ""}, {"name": "Optional[str] _validate_login_payload(data: Dict[str, Any])", "description": "Validates login request data ensuring email and password are present.", "scope": "", "scopeKind": ""}, {"name": "signup()", "description": "Endpoint to create new users, store hashed passwords, and issue JWT tokens.", "scope": "", "scopeKind": ""}, {"name": "login()", "description": "Endpoint to authenticate users and provide JWT tokens upon successful login.", "scope": "", "scopeKind": ""}, {"name": "me()", "description": "Fetches current authenticated user info from JWT payload.", "scope": "", "scopeKind": ""}, {"name": "admin_ping()", "description": "Protected route requiring 'admin' role, returns a pong message.", "scope": "", "scopeKind": ""}, {"name": "decorator(f)", "scope": "roles_required", "scopeKind": "function", "description": "unavailable"}, {"name": "\"JwtConfig\" from_env()", "scope": "JwtConfig", "scopeKind": "class", "description": "unavailable"}, {"name": "wrapper(*args, **kwargs)", "scope": "jwt_required", "scopeKind": "function", "description": "unavailable"}], "calls": ["jwt.encode", "jwt.decode", "generate_password_hash", "check_password_hash", "os.getenv", "datetime.datetime.utcnow", "JwtConfig.from_env"], "search-terms": ["JWT authentication", "Flask auth module", "user signup login", "role-based access control", "jwt_required decorator", "In-memory user store", "auth blueprint"], "state": 2, "file_id": 8, "knowledge_revision": 31, "git_revision": "33676f50dbd6cd321d67cbddd2476c6e839e5be5", "revision_history": [{"18": ""}, {"26": "e01713babe97f5fa6ae4aadb69ee56a045c6b141"}, {"31": "33676f50dbd6cd321d67cbddd2476c6e839e5be5"}], "ctags": [{"_type": "tag", "name": "JwtConfig", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^class JwtConfig:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "_USERS", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^_USERS: Dict[str, Dict[str, Any]] = {}$/", "language": "Python", "typeref": "typename:Dict[str, Dict[str, Any]]", "kind": "variable"}, {"_type": "tag", "name": "_issue_token", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^def _issue_token(sub: str, role: str, extra: Optional[Dict[str, Any]] = None) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(sub: str, role: str, extra: Optional[Dict[str, Any]] = None)"}, {"_type": "tag", "name": "_validate_login_payload", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^def _validate_login_payload(data: Dict[str, Any]) -> Optional[str]:$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "function", "signature": "(data: Dict[str, Any])"}, {"_type": "tag", "name": "_validate_signup_payload", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^def _validate_signup_payload(data: Dict[str, Any]) -> Optional[str]:$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "function", "signature": "(data: Dict[str, Any])"}, {"_type": "tag", "name": "_verify_token", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^def _verify_token(token: str) -> Tuple[bool, Optional[Dict[str, Any]], Optional[str]]:$/", "language": "Python", "typeref": "typename:Tuple[bool,Optional[Dict[str,Any]],Optional[str]]", "kind": "function", "signature": "(token: str)"}, {"_type": "tag", "name": "admin_ping", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^def admin_ping():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "blp", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^blp = Blueprint($/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "decorator", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^    def decorator(f):$/", "file": true, "language": "Python", "kind": "function", "signature": "(f)", "scope": "roles_required", "scopeKind": "function"}, {"_type": "tag", "name": "from_env", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^    def from_env() -> \"JwtConfig\":$/", "language": "Python", "typeref": "typename:\"JwtConfig\"", "kind": "member", "signature": "()", "scope": "JwtConfig", "scopeKind": "class"}, {"_type": "tag", "name": "jwt_required", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^def jwt_required(f):$/", "language": "Python", "kind": "function", "signature": "(f)"}, {"_type": "tag", "name": "login", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^def login():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "me", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^def me():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "roles_required", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^def roles_required(*roles: str):$/", "language": "Python", "kind": "function", "signature": "(*roles: str)"}, {"_type": "tag", "name": "signup", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^def signup():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "wrapper", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^        def wrapper(*args, **kwargs):$/", "file": true, "language": "Python", "kind": "function", "signature": "(*args, **kwargs)", "scope": "roles_required.decorator", "scopeKind": "function"}, {"_type": "tag", "name": "wrapper", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^    def wrapper(*args, **kwargs):$/", "file": true, "language": "Python", "kind": "function", "signature": "(*args, **kwargs)", "scope": "jwt_required", "scopeKind": "function"}], "hash": "d1df8456b40e90bc179b10fc2fc4c6c6", "format-version": 4, "code-base-name": "firebase_functions", "filename": "firebase_functions/app/auth.py", "fields": [{"name": "Dict[str, Dict[str, Any]] _USERS", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "blp = Blueprint(", "scope": "", "scopeKind": "", "description": "unavailable"}]}