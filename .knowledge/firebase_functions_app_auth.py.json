{"is_source_file": true, "format": "Python", "description": "This file implements authentication functionality for a Flask-based web application, including signup, login, JWT token issuance and verification, and role-based access control. It defines routes under the '/auth' Blueprint and manages in-memory user data for demonstration purposes.", "external_files": ["flask", "werkzeug.security", "jwt"], "external_methods": ["generate_password_hash", "check_password_hash", "jwt.encode", "jwt.decode", "request.get_json", "jsonify", "g"], "published": ["jwt_required", "roles_required"], "classes": [{"name": "JwtConfig", "description": "Dataclass that loads and holds JWT configuration such as secret key, algorithm, and token expiration time."}], "methods": [{"name": "str _issue_token(sub: str, role: str, extra: Optional[Dict[str, Any]] = None)", "description": "Creates and returns a signed JWT token with user subject, role, and optional extra claims.", "scope": "", "scopeKind": ""}, {"name": "Tuple[bool,Optional[Dict[str,Any]],Optional[str]] _verify_token(token: str)", "description": "Verifies a JWT token's validity and decodes its payload, handling expiration and invalid token errors.", "scope": "", "scopeKind": ""}, {"name": "jwt_required(f)", "description": "Decorator that enforces presence of a valid JWT token in the request's Authorization header.", "scope": "", "scopeKind": ""}, {"name": "roles_required(*roles: str)", "description": "Decorator that restricts access to users with specified roles based on the JWT payload.", "scope": "", "scopeKind": ""}, {"name": "Optional[str] _validate_signup_payload(data: Dict[str, Any])", "description": "Validates the JSON payload for the signup endpoint for required fields and role constraints.", "scope": "", "scopeKind": ""}, {"name": "Optional[str] _validate_login_payload(data: Dict[str, Any])", "description": "Validates the JSON payload for the login endpoint for required fields.", "scope": "", "scopeKind": ""}, {"name": "signup()", "description": "HTTP endpoint for user registration, generating a JWT token upon successful signup, storing user info in memory.", "scope": "", "scopeKind": ""}, {"name": "login()", "description": "HTTP endpoint for authenticating users and issuing JWT tokens upon valid credentials.", "scope": "", "scopeKind": ""}, {"name": "me()", "description": "HTTP endpoint to retrieve current user info from JWT token.", "scope": "", "scopeKind": ""}, {"name": "admin_ping()", "description": "A protected admin-only route to test role-based access control.", "scope": "", "scopeKind": ""}, {"name": "decorator(f)", "scope": "roles_required", "scopeKind": "function", "description": "unavailable"}, {"name": "\"JwtConfig\" from_env()", "scope": "JwtConfig", "scopeKind": "class", "description": "unavailable"}, {"name": "wrapper(*args, **kwargs)", "scope": "jwt_required", "scopeKind": "function", "description": "unavailable"}], "calls": ["JwtConfig.from_env()", "jwt.encode()", "jwt.decode()", "generate_password_hash()", "check_password_hash()"], "search-terms": ["authentication blueprint", "JWT token issuance", "role-based access control", "signup endpoint", "login endpoint", "in-memory user store", "JWT configuration in Python", "decorators for authorization"], "state": 2, "file_id": 8, "knowledge_revision": 18, "git_revision": "", "ctags": [{"_type": "tag", "name": "JwtConfig", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^class JwtConfig:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "_USERS", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^_USERS: Dict[str, Dict[str, Any]] = {}$/", "language": "Python", "typeref": "typename:Dict[str, Dict[str, Any]]", "kind": "variable"}, {"_type": "tag", "name": "_issue_token", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^def _issue_token(sub: str, role: str, extra: Optional[Dict[str, Any]] = None) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(sub: str, role: str, extra: Optional[Dict[str, Any]] = None)"}, {"_type": "tag", "name": "_validate_login_payload", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^def _validate_login_payload(data: Dict[str, Any]) -> Optional[str]:$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "function", "signature": "(data: Dict[str, Any])"}, {"_type": "tag", "name": "_validate_signup_payload", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^def _validate_signup_payload(data: Dict[str, Any]) -> Optional[str]:$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "function", "signature": "(data: Dict[str, Any])"}, {"_type": "tag", "name": "_verify_token", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^def _verify_token(token: str) -> Tuple[bool, Optional[Dict[str, Any]], Optional[str]]:$/", "language": "Python", "typeref": "typename:Tuple[bool,Optional[Dict[str,Any]],Optional[str]]", "kind": "function", "signature": "(token: str)"}, {"_type": "tag", "name": "admin_ping", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^def admin_ping():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "blp", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^blp = Blueprint($/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "decorator", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^    def decorator(f):$/", "file": true, "language": "Python", "kind": "function", "signature": "(f)", "scope": "roles_required", "scopeKind": "function"}, {"_type": "tag", "name": "from_env", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^    def from_env() -> \"JwtConfig\":$/", "language": "Python", "typeref": "typename:\"JwtConfig\"", "kind": "member", "signature": "()", "scope": "JwtConfig", "scopeKind": "class"}, {"_type": "tag", "name": "jwt_required", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^def jwt_required(f):$/", "language": "Python", "kind": "function", "signature": "(f)"}, {"_type": "tag", "name": "login", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^def login():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "me", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^def me():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "roles_required", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^def roles_required(*roles: str):$/", "language": "Python", "kind": "function", "signature": "(*roles: str)"}, {"_type": "tag", "name": "signup", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^def signup():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "wrapper", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^        def wrapper(*args, **kwargs):$/", "file": true, "language": "Python", "kind": "function", "signature": "(*args, **kwargs)", "scope": "roles_required.decorator", "scopeKind": "function"}, {"_type": "tag", "name": "wrapper", "path": "/home/kavia/workspace/code-generation/attendance-tracker-221712-221722/firebase_functions/app/auth.py", "pattern": "/^    def wrapper(*args, **kwargs):$/", "file": true, "language": "Python", "kind": "function", "signature": "(*args, **kwargs)", "scope": "jwt_required", "scopeKind": "function"}], "hash": "e6f797364247e4728b0160af4127111b", "format-version": 4, "code-base-name": "firebase_functions", "filename": "firebase_functions/app/auth.py", "fields": [{"name": "Dict[str, Dict[str, Any]] _USERS", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "blp = Blueprint(", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"18": ""}]}